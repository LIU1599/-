<template>
  <div class="w-screen min-h-screen px-0 mx-0 p-6">
    <router-link to="/" class="inline-block mb-6 px-4 py-2 rounded-lg bg-purple-100 text-purple-700 font-semibold shadow hover:bg-purple-200 transition-all">â† å›åˆ°ä¸»é¡µ</router-link>
    <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
      <h1 class="text-3xl font-bold mb-2 text-purple-700 flex items-center"><span class="mr-2">ğŸ“Š</span>Echarts æ•°æ®å¯è§†åŒ–</h1>
      <p class="text-gray-700 mb-4">Echarts æ˜¯ä¸€ä¸ªåŸºäº JavaScript çš„å¼€æºå¯è§†åŒ–å›¾è¡¨åº“ï¼Œé€‚åˆæ•°æ®å¯è§†åŒ–å±•ç¤ºã€‚ä¸‹æ–¹å¯åˆ‡æ¢ä¸åŒæ•°æ®é›†å’Œå›¾è¡¨ç±»å‹ï¼Œä½“éªŒäº¤äº’å¼å›¾è¡¨ã€‚</p>
      <div class="border-l-4 border-purple-400 pl-4 mb-6 text-gray-600">
        <b>äº¤äº’æ¼”ç¤ºï¼š</b>é€‰æ‹©ä¸åŒæ•°æ®é›†å’Œå›¾è¡¨ç±»å‹ï¼Œå®æ—¶åˆ‡æ¢å±•ç¤ºã€‚
      </div>
    </div>

    <div class="bg-purple-50 rounded-xl p-6 mb-8">
      <h2 class="text-xl font-semibold mb-2 text-purple-600">å›¾è¡¨æ¼”ç¤º</h2>
      <div class="flex flex-wrap gap-4 mb-4">
        <label class="flex items-center gap-2">
          <input type="radio" v-model="chartType" value="line" /> æŠ˜çº¿å›¾
        </label>
        <label class="flex items-center gap-2">
          <input type="radio" v-model="chartType" value="bar" /> æŸ±çŠ¶å›¾
        </label>
        <select v-model="dataSet" class="border rounded px-2 py-1">
          <option value="week">æœ¬å‘¨æ•°æ®</option>
          <option value="month">æœ¬æœˆæ•°æ®</option>
          <option value="quarter">æœ¬å­£åº¦æ•°æ®</option>
        </select>
      </div>
      <div id="echarts-demo" class="w-full h-72 bg-gray-100 rounded shadow"></div>
      <div class="text-gray-500 text-sm mt-2">å¯é€šè¿‡ä¸Šæ–¹æ§ä»¶åˆ‡æ¢å›¾è¡¨ç±»å‹å’Œæ•°æ®é›†ï¼Œä½“éªŒäº¤äº’ã€‚</div>
    </div>

    <div class="bg-blue-50 rounded-xl p-6 mb-8">
      <h2 class="text-xl font-semibold mb-2 text-blue-600">ä»£ç ç‰‡æ®µ</h2>
      <div class="bg-gray-100 rounded p-4 mb-4 overflow-x-auto text-sm">
        <pre><code class="language-js">import * as echarts from 'echarts';
const chart = echarts.init(document.getElementById('echarts-demo'));
chart.setOption({
  xAxis: { type: 'category', data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'] },
  yAxis: { type: 'value' },
  series: [{ data: [120, 200, 150, 80, 70], type: 'line' }]
});</code></pre>
      </div>
    </div>

    <div class="bg-yellow-50 rounded-xl p-6 mb-8">
      <h2 class="text-xl font-semibold mb-2 text-yellow-600">å®ç”¨æŠ€å·§ & å¸¸è§å‘</h2>
      <ul class="list-disc ml-6 space-y-2 text-gray-700">
        <li>å®¹å™¨å¿…é¡»æœ‰å®½é«˜ï¼Œå¦åˆ™å›¾è¡¨æ— æ³•æ˜¾ç¤ºã€‚</li>
        <li>æ•°æ®é‡å¤§æ—¶å»ºè®®å¼€å¯æ‡’åŠ è½½ã€‚</li>
        <li>å›¾è¡¨è‡ªé€‚åº”å¯ç”¨ <code>window.onresize</code> ç›‘å¬ã€‚</li>
        <li>å¯é€šè¿‡ <code>setOption</code> åŠ¨æ€åˆ‡æ¢æ•°æ®å’Œç±»å‹ã€‚</li>
        <li>äº¤äº’æ€§å¼ºæ—¶å»ºè®®ç”¨ <code>tooltip</code>ã€<code>legend</code>ã€<code>toolbox</code> ç­‰é…ç½®ã€‚</li>
      </ul>
    </div>

    <div class="bg-green-50 rounded-xl p-6 mb-8">
      <h2 class="text-xl font-semibold mb-2 text-green-600">æ›´å¤šå®ä¾‹</h2>
      <div class="mb-6">
        <h3 class="font-bold mb-1">å¤šç³»åˆ—æŠ˜çº¿å›¾</h3>
        <div id="echarts-demo-multi" class="w-full h-60 bg-gray-100 rounded mb-2"></div>
        <div class="bg-gray-100 rounded p-2 text-xs overflow-x-auto mb-2">
          <pre><code class="language-js">option = {
  tooltip: { trigger: 'axis' },
  legend: { data: ['é‚®ä»¶è¥é”€', 'è”ç›Ÿå¹¿å‘Š'] },
  xAxis: { type: 'category', data: ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'] },
  yAxis: { type: 'value' },
  series: [
    { name: 'é‚®ä»¶è¥é”€', type: 'line', data: [120, 132, 101, 134, 90, 230, 210] },
    { name: 'è”ç›Ÿå¹¿å‘Š', type: 'line', data: [220, 182, 191, 234, 290, 330, 310] }
  ]
}
</code></pre>
        </div>
      </div>
      <div class="mb-6">
        <h3 class="font-bold mb-1">é¥¼å›¾</h3>
        <div id="echarts-demo-pie" class="w-full h-60 bg-gray-100 rounded mb-2"></div>
        <div class="bg-gray-100 rounded p-2 text-xs overflow-x-auto mb-2">
          <pre><code class="language-js">option = {
  tooltip: { trigger: 'item' },
  legend: { top: '5%', left: 'center' },
  series: [
    {
      name: 'è®¿é—®æ¥æº',
      type: 'pie',
      radius: ['40%', '70%'],
      avoidLabelOverlap: false,
      itemStyle: { borderRadius: 10, borderColor: '#fff', borderWidth: 2 },
      label: { show: false, position: 'center' },
      emphasis: { label: { show: true, fontSize: 18, fontWeight: 'bold' } },
      labelLine: { show: false },
      data: [
        { value: 1048, name: 'æœç´¢å¼•æ“' },
        { value: 735, name: 'ç›´æ¥è®¿é—®' },
        { value: 580, name: 'é‚®ä»¶è¥é”€' },
        { value: 484, name: 'è”ç›Ÿå¹¿å‘Š' },
        { value: 300, name: 'è§†é¢‘å¹¿å‘Š' }
      ]
    }
  ]
}
</code></pre>
        </div>
      </div>
      <div>
        <h3 class="font-bold mb-1">åŠ¨æ€æ•°æ®</h3>
        <div id="echarts-demo-dynamic" class="w-full h-60 bg-gray-100 rounded mb-2"></div>
        <div class="bg-gray-100 rounded p-2 text-xs overflow-x-auto mb-2">
          <pre><code class="language-js">// setInterval åŠ¨æ€æ›´æ–°æ•°æ®
</code></pre>
        </div>
      </div>
    </div>

    <div class="bg-white rounded-xl shadow p-6">
      <h2 class="text-xl font-semibold mb-2 text-purple-700">æ¨èèµ„æº</h2>
      <ul class="list-disc ml-6">
        <li><a href="https://echarts.apache.org/zh/index.html" target="_blank" class="text-purple-600 underline">Echarts å®˜æ–¹æ–‡æ¡£</a></li>
        <li><a href="https://echarts.apache.org/examples/zh/index.html" target="_blank" class="text-purple-600 underline">Echarts ç¤ºä¾‹</a></li>
      </ul>
    </div>
  </div>
</template>

<script setup>
import { ref, watch, onMounted } from 'vue'
import * as echarts from 'echarts'

const chartType = ref('line')
const dataSet = ref('week')
let chart = null

const dataMap = {
  week: {
    x: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
    y: [120, 200, 150, 80, 70, 110, 130]
  },
  month: {
    x: Array.from({length: 30}, (_, i) => `${i+1}æ—¥`),
    y: Array.from({length: 30}, () => Math.floor(Math.random()*200+50))
  },
  quarter: {
    x: ['1æœˆ', '2æœˆ', '3æœˆ'],
    y: [800, 950, 700]
  }
}

function renderChart() {
  if (!chart) {
    chart = echarts.init(document.getElementById('echarts-demo'))
  }
  const { x, y } = dataMap[dataSet.value]
  chart.setOption({
    tooltip: { trigger: 'axis' },
    legend: { data: ['æ•°æ®'] },
    toolbox: { feature: { saveAsImage: {} } },
    xAxis: { type: 'category', data: x },
    yAxis: { type: 'value' },
    series: [{ name: 'æ•°æ®', data: y, type: chartType.value, smooth: true }]
  })
  chart.resize()
}

onMounted(() => {
  renderChart()
  window.addEventListener('resize', () => chart && chart.resize())
  // å¤šç³»åˆ—æŠ˜çº¿å›¾
  const chartMulti = echarts.init(document.getElementById('echarts-demo-multi'))
  chartMulti.setOption({
    tooltip: { trigger: 'axis' },
    legend: { data: ['é‚®ä»¶è¥é”€', 'è”ç›Ÿå¹¿å‘Š'] },
    xAxis: { type: 'category', data: ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'] },
    yAxis: { type: 'value' },
    series: [
      { name: 'é‚®ä»¶è¥é”€', type: 'line', data: [120, 132, 101, 134, 90, 230, 210] },
      { name: 'è”ç›Ÿå¹¿å‘Š', type: 'line', data: [220, 182, 191, 234, 290, 330, 310] }
    ]
  })
  // é¥¼å›¾
  const chartPie = echarts.init(document.getElementById('echarts-demo-pie'))
  chartPie.setOption({
    tooltip: { trigger: 'item' },
    legend: { top: '5%', left: 'center' },
    series: [
      {
        name: 'è®¿é—®æ¥æº',
        type: 'pie',
        radius: ['40%', '70%'],
        avoidLabelOverlap: false,
        itemStyle: { borderRadius: 10, borderColor: '#fff', borderWidth: 2 },
        label: { show: false, position: 'center' },
        emphasis: { label: { show: true, fontSize: 18, fontWeight: 'bold' } },
        labelLine: { show: false },
        data: [
          { value: 1048, name: 'æœç´¢å¼•æ“' },
          { value: 735, name: 'ç›´æ¥è®¿é—®' },
          { value: 580, name: 'é‚®ä»¶è¥é”€' },
          { value: 484, name: 'è”ç›Ÿå¹¿å‘Š' },
          { value: 300, name: 'è§†é¢‘å¹¿å‘Š' }
        ]
      }
    ]
  })
  // åŠ¨æ€æ•°æ®
  const chartDynamic = echarts.init(document.getElementById('echarts-demo-dynamic'))
  let dynamicData = [120, 132, 101, 134, 90, 230, 210]
  chartDynamic.setOption({
    xAxis: { type: 'category', data: ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'] },
    yAxis: { type: 'value' },
    series: [{ data: dynamicData, type: 'line', smooth: true }]
  })
  setInterval(() => {
    dynamicData = dynamicData.map(v => v + Math.round(Math.random()*20-10))
    chartDynamic.setOption({ series: [{ data: dynamicData }] })
  }, 1500)
})

watch([chartType, dataSet], renderChart)
</script>

<style scoped>
.fade-enter-active, .fade-leave-active {
  transition: opacity 0.6s;
}
.fade-enter-from, .fade-leave-to {
  opacity: 0;
}
</style> 